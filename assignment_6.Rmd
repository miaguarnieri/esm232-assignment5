---
title: 'Assignment 6: Sobol Sensitivity Analysis'
author: "Mia Guarnieri, Lauren Harris"
date: "2023-05-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(deSolve)
library(sensitivity)
library(here)
```

# Source the function and run it for 300 years

```{r sen}
source(here("R", "forest_growth.R"))

#initial forest size (carbon)
C <- 10

#initial parameters
K <- 250
r <- 0.01
g <- 2
closure <- 50

#run the model for 300 years using ODE solver

#set up parameters
simtimes <- seq(from = 1, to = 300)
parms <- list(r = r, K = K, g = g, closure = closure)


result1 <- ode(y = C, time = simtimes, func = forest_growth, parms = parms)

#turn into a df for plotting
res1_df <- as.data.frame(result1)
colnames(res1_df) = c("time", "forest_size")

```

